# 测试指南 - 视频剪辑功能

## 快速测试步骤

### 测试 1: 时间戳水印功能 ✅

**目的**: 验证导出的视频是否包含时间戳

**步骤**:
1. 打开 TeslaCam Player
2. 选择并播放任意视频
3. 点击 ✂️ 图标进入剪辑模式
4. 拖动蓝色手柄选择一段时间 (例如: 00:10 - 00:40)
5. 再次点击 ✂️ 打开导出对话框
6. 配置:
   - ✅ 勾选 "前" 摄像头
   - ✅ **勾选 "添加时间水印"**
   - ❌ 不勾选 "合成四宫格"
7. 点击 "开始导出"
8. 等待处理完成 (约30秒)
9. 下载完成后,用播放器打开视频

**预期结果**:
- ✅ 视频左上角显示时间戳
- ✅ 时间格式: YYYY-MM-DD HH:mm:ss
- ✅ 黑色半透明背景,白色文字
- ✅ 时间随视频播放实时更新

**失败标志**:
- ❌ 视频上没有任何时间显示
- ❌ 时间戳位置错误或样式异常

---

### 测试 2: 四宫格视频合成 ✅

**目的**: 验证多摄像头是否合成为单个视频

**步骤**:
1. 打开 TeslaCam Player
2. 选择并播放任意视频
3. 点击 ✂️ 图标进入剪辑模式
4. 拖动蓝色手柄选择一段时间 (例如: 00:10 - 00:40)
5. 再次点击 ✂️ 打开导出对话框
6. 配置:
   - ✅ **勾选所有摄像头** (前、后、左、右)
   - ✅ 勾选 "添加时间水印"
   - ✅ **勾选 "合成四宫格视频"**  ← 关键!
7. 点击 "开始导出"
8. 等待处理完成 (约2分钟)
9. 检查下载的文件数量和内容

**预期结果**:
- ✅ **只下载 1 个文件** (文件名: TeslaCam_grid_xxx.webm)
- ✅ 视频显示 2x2 网格布局
- ✅ 布局:
  ```
  ┌─────────┬─────────┐
  │  FRONT  │  BACK   │
  ├─────────┼─────────┤
  │  LEFT   │  RIGHT  │
  └─────────┴─────────┘
  ```
- ✅ 每个画面左上角有摄像头标签 (FRONT, BACK, LEFT, RIGHT)
- ✅ 底部中央显示统一时间戳
- ✅ 所有画面同步播放

**失败标志**:
- ❌ 下载了 4 个独立文件
- ❌ 视频不是网格布局
- ❌ 画面不同步

---

### 测试 3: 分别导出多个摄像头 ✅

**目的**: 验证可以同时导出多个独立的摄像头视频

**步骤**:
1. 打开 TeslaCam Player
2. 选择并播放任意视频
3. 点击 ✂️ 图标进入剪辑模式
4. 拖动蓝色手柄选择一段时间
5. 再次点击 ✂️ 打开导出对话框
6. 配置:
   - ✅ 勾选 "前" 和 "后" 摄像头
   - ✅ 勾选 "添加时间水印"
   - ❌ **不勾选 "合成四宫格视频"**  ← 关键!
7. 点击 "开始导出"
8. 等待处理完成
9. 检查下载的文件

**预期结果**:
- ✅ 下载 **2 个独立文件**:
  - TeslaCam_front_xxx.webm
  - TeslaCam_back_xxx.webm
- ✅ 每个文件都是单摄像头视频
- ✅ 每个文件都有自己的时间戳(如果勾选了)

**失败标志**:
- ❌ 只下载了 1 个文件
- ❌ 文件内容是合成的

---

### 测试 4: 不添加时间戳 ✅

**目的**: 验证时间戳选项可以正确关闭

**步骤**:
1. 打开 TeslaCam Player
2. 选择并播放任意视频
3. 点击 ✂️ 图标进入剪辑模式
4. 拖动蓝色手柄选择一段时间
5. 再次点击 ✂️ 打开导出对话框
6. 配置:
   - ✅ 勾选 "前" 摄像头
   - ❌ **不勾选 "添加时间水印"**  ← 关键!
   - ❌ 不勾选 "合成四宫格"
7. 点击 "开始导出"
8. 等待处理完成 (应该很快,约5秒)
9. 下载完成后,用播放器打开视频

**预期结果**:
- ✅ 视频上**没有时间戳**
- ✅ 导出速度很快 (几乎瞬间)
- ✅ 视频是原始文件

**失败标志**:
- ❌ 视频上仍显示时间戳

---

### 测试 5: 时间范围选择 ✅

**目的**: 验证时间范围选择功能

**步骤**:
1. 打开 TeslaCam Player
2. 选择并播放任意视频
3. 点击 ✂️ 图标进入剪辑模式
4. 观察进度条变化:
   - 应该出现蓝色高亮选区
   - 应该出现两个蓝色拖拽手柄
5. 拖动左侧手柄到 00:15
6. 拖动右侧手柄到 00:45
7. 点击 ✂️ 打开导出对话框
8. 检查对话框中的信息

**预期结果**:
- ✅ "选中时长" 显示 00:30 (30秒)
- ✅ "起始时间" 和 "结束时间" 正确显示
- ✅ 时间计算准确

**失败标志**:
- ❌ 时长计算错误
- ❌ 时间显示不准确

---

## 边界测试

### 测试 6: 只选择一个摄像头 + 四宫格

**步骤**:
- 只勾选 "前" 摄像头
- 勾选 "合成四宫格视频"

**预期**: 
- 应该导出单摄像头视频 (因为没有多个摄像头可以合成)
- 或者显示提示信息

### 测试 7: 不选择任何摄像头

**步骤**:
- 不勾选任何摄像头
- 点击 "开始导出"

**预期**:
- ✅ 显示错误提示: "请至少选择一个摄像头"

### 测试 8: 极短时间范围 (< 1秒)

**步骤**:
- 选择非常短的时间范围 (例如: 0.5秒)
- 导出

**预期**:
- 应该能正常导出
- 或显示合理的错误信息

---

## 性能测试

### 测试 9: 长视频剪辑 (2分钟)

**步骤**:
1. 选择 2 分钟的时间范围
2. 导出单摄像头 + 时间戳

**预期**:
- 处理时间: 约 2-3 分钟
- 文件大小: 约 75 MB
- 内存使用正常

### 测试 10: 四宫格长视频 (2分钟)

**步骤**:
1. 选择 2 分钟的时间范围
2. 导出四宫格 + 时间戳

**预期**:
- 处理时间: 约 4-5 分钟
- 文件大小: 约 120 MB
- 内存使用较高但可接受

---

## 兼容性测试

### 测试 11: 不同浏览器

**测试浏览器**:
- Chrome (推荐)
- Edge
- Firefox
- Safari (如果可用)

**预期**:
- Chrome/Edge/Firefox: ✅ 完全支持
- Safari: 可能需要插件或有限制

### 测试 12: 不同操作系统

**测试平台**:
- Windows
- macOS
- Linux

**预期**: 都应该正常工作

---

## 错误处理测试

### 测试 13: 中断导出

**步骤**:
1. 开始导出
2. 在处理过程中点击 "取消"

**预期**:
- ✅ 导出停止
- ✅ 模态框关闭
- ✅ 不下载文件

### 测试 14: 缺少视频文件

**步骤**:
1. 选择一个摄像头没有视频的时间段
2. 尝试导出该摄像头

**预期**:
- ✅ 显示错误提示
- 或跳过该摄像头

---

## 测试清单

使用此清单追踪测试进度:

- [ ] 测试 1: 时间戳水印功能
- [ ] 测试 2: 四宫格视频合成
- [ ] 测试 3: 分别导出多个摄像头
- [ ] 测试 4: 不添加时间戳
- [ ] 测试 5: 时间范围选择
- [ ] 测试 6: 只选择一个摄像头 + 四宫格
- [ ] 测试 7: 不选择任何摄像头
- [ ] 测试 8: 极短时间范围
- [ ] 测试 9: 长视频剪辑
- [ ] 测试 10: 四宫格长视频
- [ ] 测试 11: 不同浏览器
- [ ] 测试 12: 不同操作系统
- [ ] 测试 13: 中断导出
- [ ] 测试 14: 缺少视频文件

---

## 报告问题

如果发现问题,请记录:

1. **问题描述**: 详细说明问题
2. **重现步骤**: 如何触发问题
3. **预期行为**: 应该发生什么
4. **实际行为**: 实际发生了什么
5. **环境信息**: 浏览器、操作系统、版本
6. **截图/视频**: 如果可能,提供视觉证据

---

## 已知限制

当前版本的已知限制:

1. **只处理第一个片段**: 如果选区跨越多个1分钟片段,只会导出第一个
2. **固定起始位置**: 从片段开始位置导出,不支持精确剪辑
3. **WebM 格式**: 只支持 WebM 输出,不支持 MP4
4. **固定水印样式**: 无法自定义时间戳位置、大小、颜色

这些限制在文档中已明确说明,不算 bug。
